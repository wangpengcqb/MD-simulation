clear all


P = [0 0 0.007860 0.016125 0;
     0 0.003026 0.006326 0 0;
     0 0.003180 0 0 0;
     0 0 0 0 0;
     0 0 0 0 0]';

 
coeff = 0;


for i = 1:4
for j = 1:4
% i = 2;
% j = 2;


N1 = [j-1 i-1];
N2 = [j-1 i];
N3 = [j i-1];
N4 = [j i];

x1 = N1(1);
y1 = N1(2);
x2 = N2(1);
y2 = N2(2);
x3 = N3(1);
y3 = N3(2);
x4 = N4(1);
y4 = N4(2);


z1 = [P(x1+1,y1+1) 0 0 0];
z2 = [P(x2+1,y2+1) 0 0 0];
z3 = [P(x3+1,y3+1) 0 0 0];
z4 = [P(x4+1,y4+1) 0 0 0];


% z1 = [0 0 0 0];
% z2 = [-0.027603 0 0 0];
% z3 = [-0.010960 0 0 0];
% z4 = [0.003180 0 0 0];




z = [z1 z2 z3 z4]';

M = zeros(16,16);


M(1,1) = 1;
M(1,2) = x1;
M(1,3) = x1^2;
M(1,4) = x1^3;
M(1,5) = y1;
M(1,6) = x1*y1;
M(1,7) = x1^2*y1;
M(1,8) = x1^3*y1;
M(1,9) = y1^2;
M(1,10) = x1*y1^2;
M(1,11) = x1^2*y1^2;
M(1,12) = x1^3*y1^2;
M(1,13) = y1^3;
M(1,14) = x1*y1^3;
M(1,15) = x1^2*y1^3;
M(1,16) = x1^3*y1^3;

M(2,1) = 0;
M(2,2) = 1;
M(2,3) = 2*x1;
M(2,4) = 3*x1^2;
M(2,5) = 0;
M(2,6) = y1;
M(2,7) = 2*x1*y1;
M(2,8) = 3*x1^2*y1;
M(2,9) = 0;
M(2,10) = y1^2;
M(2,11) = 2*x1*y1^2;
M(2,12) = 3*x1^2*y1^2;
M(2,13) = 0;
M(2,14) = y1^3;
M(2,15) = 2*x1*y1^3;
M(2,16) = 3*x1^2*y1^3;

M(3,1) = 0;
M(3,2) = 0;
M(3,3) = 0;
M(3,4) = 0;
M(3,5) = 1;
M(3,6) = x1;
M(3,7) = x1^2;
M(3,8) = x1^3;
M(3,9) = 2*y1;
M(3,10) = 2*x1*y1;
M(3,11) = 2*x1^2*y1;
M(3,12) = 2*x1^3*y1;
M(3,13) = 3*y1^2;
M(3,14) = 3*x1*y1^2;
M(3,15) = 3*x1^2*y1^2;
M(3,16) = 3*x1^3*y1^2;

M(4,1) = 0;
M(4,2) = 0;
M(4,3) = 0;
M(4,4) = 0;
M(4,5) = 0;
M(4,6) = 1;
M(4,7) = 2*x1;
M(4,8) = 3*x1^2;
M(4,9) = 0;
M(4,10) = 2*y1;
M(4,11) = 4*x1*y1;
M(4,12) = 6*x1^2*y1;
M(4,13) = 0;
M(4,14) = 3*y1^2;
M(4,15) = 6*x1*y1^2;
M(4,16) = 9*x1^2*y1^2;


M(5,1) = 1;
M(5,2) = x2;
M(5,3) = x2^2;
M(5,4) = x2^3;
M(5,5) = y2;
M(5,6) = x2*y2;
M(5,7) = x2^2*y2;
M(5,8) = x2^3*y2;
M(5,9) = y2^2;
M(5,10) = x2*y2^2;
M(5,11) = x2^2*y2^2;
M(5,12) = x2^3*y2^2;
M(5,13) = y2^3;
M(5,14) = x2*y2^3;
M(5,15) = x2^2*y2^3;
M(5,16) = x2^3*y2^3;

M(6,1) = 0;
M(6,2) = 1;
M(6,3) = 2*x2;
M(6,4) = 3*x2^2;
M(6,5) = 0;
M(6,6) = y2;
M(6,7) = 2*x2*y2;
M(6,8) = 3*x2^2*y2;
M(6,9) = 0;
M(6,10) = y2^2;
M(6,11) = 2*x2*y2^2;
M(6,12) = 3*x2^2*y2^2;
M(6,13) = 0;
M(6,14) = y2^3;
M(6,15) = 2*x2*y2^3;
M(6,16) = 3*x2^2*y2^3;

M(7,1) = 0;
M(7,2) = 0;
M(7,3) = 0;
M(7,4) = 0;
M(7,5) = 1;
M(7,6) = x2;
M(7,7) = x2^2;
M(7,8) = x2^3;
M(7,9) = 2*y2;
M(7,10) = 2*x2*y2;
M(7,11) = 2*x2^2*y2;
M(7,12) = 2*x2^3*y2;
M(7,13) = 3*y2^2;
M(7,14) = 3*x2*y2^2;
M(7,15) = 3*x2^2*y2^2;
M(7,16) = 3*x2^3*y2^2;

M(8,1) = 0;
M(8,2) = 0;
M(8,3) = 0;
M(8,4) = 0;
M(8,5) = 0;
M(8,6) = 1;
M(8,7) = 2*x2;
M(8,8) = 3*x2^2;
M(8,9) = 0;
M(8,10) = 2*y2;
M(8,11) = 4*x2*y2;
M(8,12) = 6*x2^2*y2;
M(8,13) = 0;
M(8,14) = 3*y2^2;
M(8,15) = 6*x2*y2^2;
M(8,16) = 9*x2^2*y2^2;


M(9,1) = 1;
M(9,2) = x3;
M(9,3) = x3^2;
M(9,4) = x3^3;
M(9,5) = y3;
M(9,6) = x3*y3;
M(9,7) = x3^2*y3;
M(9,8) = x3^3*y3;
M(9,9) = y3^2;
M(9,10) = x3*y3^2;
M(9,11) = x3^2*y3^2;
M(9,12) = x3^3*y3^2;
M(9,13) = y3^3;
M(9,14) = x3*y3^3;
M(9,15) = x3^2*y3^3;
M(9,16) = x3^3*y3^3;

M(10,1) = 0;
M(10,2) = 1;
M(10,3) = 2*x3;
M(10,4) = 3*x3^2;
M(10,5) = 0;
M(10,6) = y3;
M(10,7) = 2*x3*y3;
M(10,8) = 3*x3^2*y3;
M(10,9) = 0;
M(10,10) = y3^2;
M(10,11) = 2*x3*y3^2;
M(10,12) = 3*x3^2*y3^2;
M(10,13) = 0;
M(10,14) = y3^3;
M(10,15) = 2*x3*y3^3;
M(10,16) = 3*x3^2*y3^3;

M(11,1) = 0;
M(11,2) = 0;
M(11,3) = 0;
M(11,4) = 0;
M(11,5) = 1;
M(11,6) = x3;
M(11,7) = x3^2;
M(11,8) = x3^3;
M(11,9) = 2*y3;
M(11,10) = 2*x3*y3;
M(11,11) = 2*x3^2*y3;
M(11,12) = 2*x3^3*y3;
M(11,13) = 3*y3^2;
M(11,14) = 3*x3*y3^2;
M(11,15) = 3*x3^2*y3^2;
M(11,16) = 3*x3^3*y3^2;

M(12,1) = 0;
M(12,2) = 0;
M(12,3) = 0;
M(12,4) = 0;
M(12,5) = 0;
M(12,6) = 1;
M(12,7) = 2*x3;
M(12,8) = 3*x3^2;
M(12,9) = 0;
M(12,10) = 2*y3;
M(12,11) = 4*x3*y3;
M(12,12) = 6*x3^2*y3;
M(12,13) = 0;
M(12,14) = 3*y3^2;
M(12,15) = 6*x3*y3^2;
M(12,16) = 9*x3^2*y3^2;


M(13,1) = 1;
M(13,2) = x4;
M(13,3) = x4^2;
M(13,4) = x4^3;
M(13,5) = y4;
M(13,6) = x4*y4;
M(13,7) = x4^2*y4;
M(13,8) = x4^3*y4;
M(13,9) = y4^2;
M(13,10) = x4*y4^2;
M(13,11) = x4^2*y4^2;
M(13,12) = x4^3*y4^2;
M(13,13) = y4^3;
M(13,14) = x4*y4^3;
M(13,15) = x4^2*y4^3;
M(13,16) = x4^3*y4^3;

M(14,1) = 0;
M(14,2) = 1;
M(14,3) = 2*x4;
M(14,4) = 3*x4^2;
M(14,5) = 0;
M(14,6) = y4;
M(14,7) = 2*x4*y4;
M(14,8) = 3*x4^2*y4;
M(14,9) = 0;
M(14,10) = y4^2;
M(14,11) = 2*x4*y4^2;
M(14,12) = 3*x4^2*y4^2;
M(14,13) = 0;
M(14,14) = y4^3;
M(14,15) = 2*x4*y4^3;
M(14,16) = 3*x4^2*y4^3;

M(15,1) = 0;
M(15,2) = 0;
M(15,3) = 0;
M(15,4) = 0;
M(15,5) = 1;
M(15,6) = x4;
M(15,7) = x4^2;
M(15,8) = x4^3;
M(15,9) = 2*y4;
M(15,10) = 2*x4*y4;
M(15,11) = 2*x4^2*y4;
M(15,12) = 2*x4^3*y4;
M(15,13) = 3*y4^2;
M(15,14) = 3*x4*y4^2;
M(15,15) = 3*x4^2*y4^2;
M(15,16) = 3*x4^3*y4^2;

M(16,1) = 0;
M(16,2) = 0;
M(16,3) = 0;
M(16,4) = 0;
M(16,5) = 0;
M(16,6) = 1;
M(16,7) = 2*x4;
M(16,8) = 3*x4^2;
M(16,9) = 0;
M(16,10) = 2*y4;
M(16,11) = 4*x4*y4;
M(16,12) = 6*x4^2*y4;
M(16,13) = 0;
M(16,14) = 3*y4^2;
M(16,15) = 6*x4*y4^2;
M(16,16) = 9*x4^2*y4^2;



b = M\z;

a = zeros(16,1);

a(1) = b(1);
a(2) = b(5);
a(3) = b(9);
a(4) = b(13); 
a(5) = b(2);
a(6) = b(6);
a(7) = b(10);
a(8) = b(14);
a(9) = b(3);
a(10) = b(7);
a(11) = b(11);
a(12) = b(15); 
a(13) = b(4);
a(14) = b(8);
a(15) = b(12);
a(16) = b(16);  
 

coeff = [coeff; b];


end
end

coeff(1) = [];

for i = 1:length(coeff)
    
    a = coeff(i)*(10^10);
    a = round(a);
    coeff(i) = a/(10^10);
 
    if coeff(i) == 0
        coeff(i) = abs(coeff(i));
    end
end


fid=fopen('pcc.data', 'wt');
fprintf(fid, 'pcc');
fprintf(fid, '\n');

for i = 1:length(coeff)
    fprintf(fid, '    ');
    fprintf(fid,'%16.10f',coeff(i));
    fprintf(fid, '\n'); 
end
 
 
 